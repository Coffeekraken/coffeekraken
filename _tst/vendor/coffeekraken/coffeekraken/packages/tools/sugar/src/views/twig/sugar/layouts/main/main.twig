<!--
/**
 * @name               main
 * @namespace          php.views.layouts
 * @type               blade
 *
 * Main layout that handle things like scripts import, stylesheets import, etc...
 *
 * @since            2.0.0
 * @author 	        Olivier Bossel <olivier.bossel@gmail.com> (https://coffeekraken.io)
 */
-->

{% set ogObj = {} %}
{% if metas and metas.og %}
    {% set ogObj = metas.og %}
{% endif %}

{% if frontspec.metas.og %}
    {% set ogObj = frontspec.metas.og|toArray|merge(ogObj) %}
{% endif %}

{% if not metas %}
    {% set metas = [] %}
{% endif %}

{% set metasObj = metas %}
{% if frontspec.metas %}
    {% set metasObj = frontspec.metas|toArray|merge(metas) %}
{% endif %}

{% set lang = 'en' %}
{% if metas.lang %}
    {% set lang = metas.lang %}
{% elseif frontspec.metas.lang %}
    {% set lang = frontspec.metas.lang %}
{% endif %}

{% set dir = 'ltr' %}
{% if metas.dir %}
    {% set dir = metas.dir %}
{% elseif frontspec.metas.dir %}
    {% set dir = frontspec.metas.dir %}
{% endif %}

<!DOCTYPE html>
<html lang="{{ lang }}" dir="{{ dir }}" class="{{ lodClasses(frontspec.lod.defaultLevel ? frontspec.lod.defaultLevel : 3) }}">
<head>
    <!-- metas -->
    {{ frontspecMetas(frontspec)|raw }}
    
    <!-- og -->
    {{ frontspecOg(frontspec|toObject)|raw }}
    
    <!-- assets -->
    {% set cacheBuster = '' %}
    {% if shared.server.sessionId %}
        {% set cacheBuster = shared.server.sessionId %}
    {% endif %}
    {{ frontspecAssets(frontspec, cacheBuster)|raw }}
        
    {% block head %}{% endblock %}

</head>

<body class="{{ bodyAttributes.class }} initial-loading loading" s-sugar {{ attrs(bodyAttributes, ['class'])|raw }}>

    {% if SUGAR or frontspec %}
    <script id="sugar-override">
        if (!document.env) document.env = {};
        {% if SUGAR %}
            document.env.SUGAR = {{ SUGAR|json_encode()|raw }};
        {% endif %}
        {% if frontspec %}
            document.env.FRONTSPEC = {{ deepDiff(readFrontspec(), frontspec)|json_encode()|raw }};
        {% endif %}
    </script>
    {% endif %}

    {% block body %}{% endblock %}

</body>
</html>

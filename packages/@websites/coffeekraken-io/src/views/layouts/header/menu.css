#header {
    ._nav {
        display: flex;
        user-select: none;
        flex-grow: 1;
        justify-content: space-evenly;
        text-align: center;
        font-size: sugar.font.size(40);

        ._main-link {
            & > *:first-child {
                position: relative;
            }

            & > *:first-child:before {
                content: '';
                position: absolute;
                top: calc(100% + 15px);
                left: 50%;
                width: 20px;
                height: 20px;
                transform: translate(-50%, 0) scale(0);
                background: sugar.color(accent);
                border-radius: 9999px;
                /* @sugar.depth (50); */
                z-index: 100;
                transition: sugar.transition(fast);
                display: none;

                @sugar.lod theme {
                    display: block;
                }
            }

            &:hover,
            &:focus-within {
                & > *:first-child {
                    color: sugar.color(accent);

                    &:before {
                        transform: translate(-50%, 0) scale(1);
                    }
                }
            }
        }

        ._subnav {
            --max-height: 60vh;

            position: absolute;
            top: 80px;
            left: 50%;
            height: calc(var(--max-height) + 96px);
            max-width: 100vw;
            transform: translateX(-50%) translateY(-200%);
            z-index: 10;
            background-color: sugar.color(main, surface);
            background-position: 0 0;
            background-size: contain;
            text-align: left;
            /* display: none; */
            overflow: hidden;
            border-radius: sugar.border.radius();
            @sugar.depth (10);
            @sugar.container (default);
            opacity: 0;
            transition: opacity 0.1s ease-out, top 0.1s ease-out;

            @sugar.media (>=wide) {
                @sugar.container (wide);
            }

            @sugar.media mobile {
                width: 100vw;
                height: 100vh;
                position: fixed;
                top: 160px;
                left: 0;
                transform: none;
                flex-direction: column;
            }
        }

        .subnav-active ._subnav {
            /* display: block; */
            /* pointer-events: all; */
            opacity: 1;
            top: 60px;
            transform: translateX(-50%) translateY(0);

            @sugar.media mobile {
                display: flex;
            }

            /* border-bottom: 1px solid sugar.color(accent, border); */
        }

        ._subnav-footer {
            background: sugar.color(main, --lighten 43);
            padding: sugar.padding(30);

            @sugar.theme.when (dark) {
                background: sugar.color(main, --darken 33);
            }
        }

        ._subnav-chapters {
            overflow-y: auto;
            height: var(--max-height);
            padding: sugar.padding(50);
            position: relative;
            @sugar.scrollbar();

            /* background: linear-gradient(
                -90deg,
                sugar.color(main, --alpha 0.03),
                sugar.color(main, --alpha 0)
            ); */

            s-activate {
                display: block;
            }

            ul {
                display: flex;
                position: relative;
                z-index: 10;
            }

            li:hover {
                background-color: sugar.color(accent, --alpha 0.5);
            }
            li:hover,
            li[active] {
                background-color: sugar.color(accent);
                color: sugar.color(accent, foreground);
            }

            li {
                padding: sugar.padding(20) sugar.padding(30);
                border-radius: sugar.border.radius(ui.default.borderRadius);
                cursor: pointer;
            }

            &:before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: sugar.color(main, surface);
                opacity: 0.95;
                z-index: -1;
            }
        }

        ._subnav-stories {
            position: relative;
            overflow-y: auto;
            height: var(--max-height);
            padding: sugar.padding(50);
            background-color: sugar.color(main, background);
            background-image: radial-gradient(
                circle at bottom,
                sugar.color(complementary, --alpha 0.02),
                transparent
            ) !important;

            @sugar.scrollbar();

            /* &:before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                
                opacity: 0.98;
            } */
        }

        ._subnav-story {
            width: 100%;

            ul {
                position: relative;
                z-index: 1;
                display: flex;
                flex-wrap: wrap;
                width: 100%;

                li {
                    padding: sugar.padding(20) sugar.padding(30);
                    border-radius: sugar.border.radius(ui.default.borderRadius);
                    cursor: pointer;
                    width: 50%;

                    &:hover {
                        background-color: sugar.color(complementary);
                        color: sugar.color(complementary, foreground);
                    }

                    &[actual-parent] {
                        background-color: sugar.color(
                            complementary,
                            --alpha 0.8
                        );
                    }
                }
            }
        }
        /* ._subnav-doc ._subnav-story li {
            width: 50%;
        } */

        ._subnav-story {
            display: none;
            position: relative;

            &[active] {
                display: block;
            }
        }

        .ck-discover p {
            @sugar.truncate (3);
        }
    }
}

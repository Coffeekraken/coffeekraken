import{a as m,n as y,b as S,d as v,o as _,p as k,c as C}from"./index.esm.js";function w(i,e){Object.assign({},e??{});let t;if(e=window.getComputedStyle(i,"::before"),e.content!=="none")try{t=JSON.parse(JSON.parse(e.content))}catch{}if(!t&&(e=window.getComputedStyle(i,"::after"),e.content))try{t=JSON.parse(JSON.parse(e.content))}catch{}return t??{}}class h extends m{static get _definition(){return{css:{type:"String",description:'Specify the "chunk" css you want to load. This is relative to the "cssChunksBasePath" property and can be a simple id like "welcome" that will resolve to "${cssChunksBasePath}/welcome.css" or directly a path'},cssChunksBasePath:{type:"String",description:"Specify the path where are stored your css chunk files",get default(){return y.get("serve.css.path")+"/chunks"}}}}}var u=globalThis&&globalThis.__awaiter||function(i,e,t,s){return new(t=t||Promise)(function(o,l){function d(c){try{n(s.next(c))}catch(a){l(a)}}function r(c){try{n(s.throw(c))}catch(a){l(a)}}function n(c){var a;c.done?o(c.value):((a=c.value)instanceof t?a:new t(function(f){f(a)})).then(d,r)}n((s=s.apply(i,e||[])).next())})};class p extends S{static registerDeps(e,t={}){v(e,(s,{cancel:o})=>u(this,void 0,void 0,function*(){const l=_(s);document.addEventListener("s-deps.resolved",d=>{d.detail.selector===e&&l.cancel()}),yield l,this.resolvedSelectors.includes(e)||(this.resolvedSelectors.push(e),document.dispatchEvent(new CustomEvent("s-deps.resolved",{detail:{selector:e,$elm:s}})),o(),t=h.apply(t??{}),this._handleDepsForElement(s,t))}))}static _checkAndApplyReadyStateForElement(e,t={}){t.css&&!e._sDepsCssStack||e._sDepsCssStack.length||(e.setAttribute("resolved","true"),e.classList.add("resolved"))}static _handleCssDepsForElement(e,t={}){var s,o;return u(this,void 0,void 0,function*(){var l=t.css.split(",").map(d=>d.trim());for(let[d,r]of(e._sDepsCssStack=l).entries())if(document.querySelector(`link[s-deps-css="${r}"]`))(o=(s=e._sDepsCssStack)==null?void 0:s.splice)!=null&&o.call(s,e._sDepsCssStack.indexOf(r),1),this._checkAndApplyReadyStateForElement(e,t);else{r.match(/\.css$/)||(r+=".css");const n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("s-deps-css",t.css),n.setAttribute("rel","preload"),n.setAttribute("as","style"),n.setAttribute("href",t.cssChunksBasePath+"/"+r),document.head.appendChild(n),k(n).then(()=>{var c,a;n.setAttribute("rel","stylesheet"),(a=(c=e._sDepsCssStack)==null?void 0:c.splice)!=null&&a.call(c,e._sDepsCssStack.indexOf(r),1),this._checkAndApplyReadyStateForElement(e,t)})}})}static _handleDepsForElement(e,t={}){t.css&&this._handleCssDepsForElement(e,t)}constructor(e,t,s){super(e,t,C({name:"s-deps",interface:h},s??{}))}mount(){return u(this,void 0,void 0,function*(){p._handleDepsForElement(this.node,this.props)})}}function D(i={},e="s-deps"){p.define(e,p,Object.assign({},i))}p._cssFrontData=w(document.body),p.resolvedSelectors=[];export{D as default};

{"version":3,"sources":["SBuildDocActionsStream.js"],"names":["__SActionsStream","require","__deepMerge","__getFilename","__SFsOutputStreamAction","__SFsReadFileStreamAction","__SGlobResolverStreamAction","__SDocblockObjectsToMarkdownStreamAction","__SUnlinkStreamAction","__path","module","exports","settings","unlink","globResolver","fsReadFile","docblocksToMarkdown","fsOutput","name","before","streamObj","globProperty","outputDir","docRoot","afterActions","input","filename","beforeActions","outputStack","data","resolve","replace","docMap"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,IAAMA,gBAAgB,GAAGC,OAAO,CAAC,6BAAD,CAAhC;;AACA,IAAMC,WAAW,GAAGD,OAAO,CAAC,wBAAD,CAA3B;;AACA,IAAME,aAAa,GAAGF,OAAO,CAAC,mBAAD,CAA7B;;AACA,IAAMG,uBAAuB,GAAGH,OAAO,CAAC,4CAAD,CAAvC;;AACA,IAAMI,yBAAyB,GAAGJ,OAAO,CAAC,8CAAD,CAAzC;;AACA,IAAMK,2BAA2B,GAAGL,OAAO,CAAC,gDAAD,CAA3C;;AACA,IAAMM,wCAAwC,GAAGN,OAAO,CAAC,mDAAD,CAAxD;;AACA,IAAMO,qBAAqB,GAAGP,OAAO,CAAC,0CAAD,CAArC;;AACA,IAAMQ,MAAM,GAAGR,OAAO,CAAC,MAAD,CAAtB;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;AAuBAS,MAAM,CAACC,OAAP;AAAA;;AAAA;;AACE;;;;;;;;;AASA,iCAAYC,QAAZ,EAA2B;AAAA,QAAfA,QAAe;AAAfA,MAAAA,QAAe,GAAJ,EAAI;AAAA;;AAAA;;AACzB;AADyB,6BAGvB;AACEC,MAAAA,MAAM,EAAEL,qBADV;AAEEM,MAAAA,YAAY,EAAER,2BAFhB;AAGES,MAAAA,UAAU,EAAEV,yBAHd;AAIEW,MAAAA,mBAAmB,EAAET,wCAJvB;AAKEU,MAAAA,QAAQ,EAAEb;AALZ,KAHuB,EAUvBF,WAAW,CACT;AACEgB,MAAAA,IAAI,EAAE,qBADR;AAEEC,MAAAA,MAAM,EAAGC,SAAD,IAAe;AACrBA,QAAAA,SAAS,CAACC,YAAV,GAAyB,OAAzB;AACAD,QAAAA,SAAS,CAACP,MAAV,GAAmBO,SAAS,CAACE,SAA7B;AACAF,QAAAA,SAAS,CAACG,OAAV,GAAoBH,SAAS,CAACE,SAA9B;AACA,eAAOF,SAAP;AACD,OAPH;AAQEI,MAAAA,YAAY,EAAE;AACZV,QAAAA,YAAY,EAAGM,SAAD,IAAe;AAC3B,cAAIA,SAAS,CAACK,KAAd,EAAqB;AACnBL,YAAAA,SAAS,CAACM,QAAV,GAAqBvB,aAAa,CAACiB,SAAS,CAACK,KAAX,CAAlC;AACD;;AACD,iBAAOL,SAAP;AACD;AANW,OARhB;AAgBEO,MAAAA,aAAa,EAAE;AACbV,QAAAA,QAAQ,EAAGG,SAAD,IAAe;AACvB,cAAI,CAACA,SAAS,CAACQ,WAAf,EAA4BR,SAAS,CAACQ,WAAV,GAAwB,EAAxB;;AAC5B,cAAIR,SAAS,CAACE,SAAV,IAAuBF,SAAS,CAACM,QAAjC,IAA6CN,SAAS,CAACS,IAA3D,EAAiE;AAC/DT,YAAAA,SAAS,CAACQ,WAAV,CAAsBC,IAAtB,GAA6BpB,MAAM,CAACqB,OAAP,CAC3BV,SAAS,CAACE,SADiB,EAE3BF,SAAS,CAACM,QAAV,CAAmBK,OAAnB,CAA2B,KAA3B,EAAkC,KAAlC,CAF2B,CAA7B;AAID;;AACD,iBAAOX,SAAP;AACD,SAVY;AAWbY,QAAAA,MAAM,EAAGZ,SAAD,IAAe;AACrBA,UAAAA,SAAS,CAACE,SAAV,GAAsBF,SAAS,CAACG,OAAhC;AACA,iBAAOH,SAAP;AACD;AAdY;AAhBjB,KADS,EAkCTR,QAlCS,CAVY;AA+C1B;;AAzDH;AAAA,EAAqDZ,gBAArD","sourcesContent":["const __SActionsStream = require('../../stream/SActionsStream');\nconst __deepMerge = require('../../object/deepMerge');\nconst __getFilename = require('../../fs/filename');\nconst __SFsOutputStreamAction = require('../../stream/actions/SFsOutputStreamAction');\nconst __SFsReadFileStreamAction = require('../../stream/actions/SFsReadFileStreamAction');\nconst __SGlobResolverStreamAction = require('../../stream/actions/SGlobResolverStreamAction');\nconst __SDocblockObjectsToMarkdownStreamAction = require('./actions/SDocblocksObjectsToMarkdownStreamAction');\nconst __SUnlinkStreamAction = require('../../stream/actions/SUnlinkStreamAction');\nconst __path = require('path');\n\n/**\n * @name            SBuildDocActionStream\n * @namespace           node.build.doc\n * @type            Class\n * @extends         SActionsStream\n *\n * This class represent a pre-configured action stream to build easily some javascript files\n *\n * @param           {Object}Â          [settings={}]         The settings object to configure your instance\n *\n * @example         js\n * const SBuildDocActionStream = require('@coffeekraken/sugar/node/build/doc/SBuildDocActionStream');\n * const myStream = new SBuildDocActionStream();\n * myStream.start({\n *    input: '...',\n *    output: '...'\n * }).on('resolve', (result) => {\n *    // do something\n * });\n *\n * @since     2.0.0\n * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nmodule.exports = class SBuildDocActionStream extends __SActionsStream {\n  /**\n   * @name        constructor\n   * @type        Function\n   * @constructor\n   *\n   * Constructor\n   *\n   * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n   */\n  constructor(settings = {}) {\n    // init actions stream\n    super(\n      {\n        unlink: __SUnlinkStreamAction,\n        globResolver: __SGlobResolverStreamAction,\n        fsReadFile: __SFsReadFileStreamAction,\n        docblocksToMarkdown: __SDocblockObjectsToMarkdownStreamAction,\n        fsOutput: __SFsOutputStreamAction\n      },\n      __deepMerge(\n        {\n          name: 'Build Documentation',\n          before: (streamObj) => {\n            streamObj.globProperty = 'input';\n            streamObj.unlink = streamObj.outputDir;\n            streamObj.docRoot = streamObj.outputDir;\n            return streamObj;\n          },\n          afterActions: {\n            globResolver: (streamObj) => {\n              if (streamObj.input) {\n                streamObj.filename = __getFilename(streamObj.input);\n              }\n              return streamObj;\n            }\n          },\n          beforeActions: {\n            fsOutput: (streamObj) => {\n              if (!streamObj.outputStack) streamObj.outputStack = {};\n              if (streamObj.outputDir && streamObj.filename && streamObj.data) {\n                streamObj.outputStack.data = __path.resolve(\n                  streamObj.outputDir,\n                  streamObj.filename.replace('.js', '.md')\n                );\n              }\n              return streamObj;\n            },\n            docMap: (streamObj) => {\n              streamObj.outputDir = streamObj.docRoot;\n              return streamObj;\n            }\n          }\n        },\n        settings\n      )\n    );\n  }\n};\n"]}
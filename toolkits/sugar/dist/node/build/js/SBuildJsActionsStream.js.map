{"version":3,"sources":["SBuildJsActionsStream.js"],"names":["__SActionsStream","require","__SWebpackStreamAction","__STerserStreamAction","__SFsReadFileStreamAction","__deepMerge","__getFilename","__SFsOutputStreamAction","__SGlobResolverStreamAction","__SSugarJsonStreamAction","__path","module","exports","settings","globResolver","readFile","sugarJson","webpack","terser","fsOutput","name","before","streamObj","globProperty","afterActions","input","filename","beforeActions","outputStack","outputDir","data","resolve","sourcemapData"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,MAAMA,gBAAgB,GAAGC,OAAO,CAAC,6BAAD,CAAhC;;AACA,MAAMC,sBAAsB,GAAGD,OAAO,CAAC,gCAAD,CAAtC;;AACA,MAAME,qBAAqB,GAAGF,OAAO,CAAC,+BAAD,CAArC;;AACA,MAAMG,yBAAyB,GAAGH,OAAO,CAAC,8CAAD,CAAzC;;AACA,MAAMI,WAAW,GAAGJ,OAAO,CAAC,wBAAD,CAA3B;;AACA,MAAMK,aAAa,GAAGL,OAAO,CAAC,mBAAD,CAA7B;;AACA,MAAMM,uBAAuB,GAAGN,OAAO,CAAC,4CAAD,CAAvC;;AACA,MAAMO,2BAA2B,GAAGP,OAAO,CAAC,gDAAD,CAA3C;;AACA,MAAMQ,wBAAwB,GAAGR,OAAO,CAAC,kCAAD,CAAxC;;AACA,MAAMS,MAAM,GAAGT,OAAO,CAAC,MAAD,CAAtB;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBAU,MAAM,CAACC,OAAP;AAAA;;AAAA;;AACE;;;;;;;;;AASA,iCAAYC,QAAZ,EAA2B;AAAA,QAAfA,QAAe;AAAfA,MAAAA,QAAe,GAAJ,EAAI;AAAA;;AAAA;;AACzB;AADyB,6BAGvB;AACEC,MAAAA,YAAY,EAAEN,2BADhB;AAEEO,MAAAA,QAAQ,EAAEX,yBAFZ;AAGEY,MAAAA,SAAS,EAAEP,wBAHb;AAIEQ,MAAAA,OAAO,EAAEf,sBAJX;AAKEgB,MAAAA,MAAM,EAAEf,qBALV;AAMEgB,MAAAA,QAAQ,EAAEZ;AANZ,KAHuB,EAWvBF,WAAW,CACT;AACEe,MAAAA,IAAI,EAAE,UADR;AAEEC,MAAAA,MAAM,EAAGC,SAAD,IAAe;AACrBA,QAAAA,SAAS,CAACC,YAAV,GAAyB,OAAzB;AACA,eAAOD,SAAP;AACD,OALH;AAMEE,MAAAA,YAAY,EAAE;AACZV,QAAAA,YAAY,EAAGQ,SAAD,IAAe;AAC3B,cAAIA,SAAS,CAACG,KAAd,EAAqB;AACnBH,YAAAA,SAAS,CAACI,QAAV,GAAqBpB,aAAa,CAACgB,SAAS,CAACG,KAAX,CAAlC;AACD;;AACD,iBAAOH,SAAP;AACD;AANW,OANhB;AAcEK,MAAAA,aAAa,EAAE;AACbR,QAAAA,QAAQ,EAAGG,SAAD,IAAe;AACvB,cAAIA,SAAS,CAACG,KAAd,EAAqB;AACnBH,YAAAA,SAAS,CAACI,QAAV,GAAqBpB,aAAa,CAACgB,SAAS,CAACG,KAAX,CAAlC;AACD;;AACD,cAAI,CAACH,SAAS,CAACM,WAAf,EAA4BN,SAAS,CAACM,WAAV,GAAwB,EAAxB;;AAC5B,cAAIN,SAAS,CAACO,SAAV,IAAuBP,SAAS,CAACI,QAAjC,IAA6CJ,SAAS,CAACQ,IAA3D,EAAiE;AAC/DR,YAAAA,SAAS,CAACM,WAAV,CAAsBE,IAAtB,GAA6BpB,MAAM,CAACqB,OAAP,CAC3BT,SAAS,CAACO,SADiB,EAE3BP,SAAS,CAACI,QAFiB,CAA7B;AAID;;AACD,cACEJ,SAAS,CAACO,SAAV,IACAP,SAAS,CAACI,QADV,IAEAJ,SAAS,CAACU,aAHZ,EAIE;AACAV,YAAAA,SAAS,CAACM,WAAV,CAAsBI,aAAtB,GAAsCtB,MAAM,CAACqB,OAAP,CACpCT,SAAS,CAACO,SAD0B,EAEpCP,SAAS,CAACI,QAAV,GAAqB,MAFe,CAAtC;AAID;;AACD,iBAAOJ,SAAP;AACD;AAvBY;AAdjB,KADS,EAyCTT,QAzCS,CAXY;AAuD1B;;AAjEH;AAAA,EAAqDb,gBAArD","sourcesContent":["const __SActionsStream = require('../../stream/SActionsStream');\nconst __SWebpackStreamAction = require('./actions/SWebpackStreamAction');\nconst __STerserStreamAction = require('./actions/STerserStreamAction');\nconst __SFsReadFileStreamAction = require('../../stream/actions/SFsReadFileStreamAction');\nconst __deepMerge = require('../../object/deepMerge');\nconst __getFilename = require('../../fs/filename');\nconst __SFsOutputStreamAction = require('../../stream/actions/SFsOutputStreamAction');\nconst __SGlobResolverStreamAction = require('../../stream/actions/SGlobResolverStreamAction');\nconst __SSugarJsonStreamAction = require('./actions/SSugarJsonStreamAction');\nconst __path = require('path');\n\n/**\n * @name            SBuildJsActionsStream\n * @namespace           node.build.js\n * @type            Class\n * @extends         SActionsStream\n *\n * This class represent a pre-configured action stream to build easily some javascript files\n *\n * @param           {Object}Â          [settings={}]         The settings object to configure your instance\n *\n * @todo        Document the streamObj required properties\n *\n * @example         js\n * const SBuildJsActionsStream = require('@coffeekraken/sugar/node/build/SBuildJsActionsStream');\n * const myStream = new SBuildJsActionsStream();\n * myStream.start({\n *    input: '...',\n *    output: '...'\n * }).on('resolve', (result) => {\n *    // do something\n * });\n *\n * @since     2.0.0\n * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nmodule.exports = class SBuildJsActionsStream extends __SActionsStream {\n  /**\n   * @name        constructor\n   * @type        Function\n   * @constructor\n   *\n   * Constructor\n   *\n   * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n   */\n  constructor(settings = {}) {\n    // init actions stream\n    super(\n      {\n        globResolver: __SGlobResolverStreamAction,\n        readFile: __SFsReadFileStreamAction,\n        sugarJson: __SSugarJsonStreamAction,\n        webpack: __SWebpackStreamAction,\n        terser: __STerserStreamAction,\n        fsOutput: __SFsOutputStreamAction\n      },\n      __deepMerge(\n        {\n          name: 'Build JS',\n          before: (streamObj) => {\n            streamObj.globProperty = 'input';\n            return streamObj;\n          },\n          afterActions: {\n            globResolver: (streamObj) => {\n              if (streamObj.input) {\n                streamObj.filename = __getFilename(streamObj.input);\n              }\n              return streamObj;\n            }\n          },\n          beforeActions: {\n            fsOutput: (streamObj) => {\n              if (streamObj.input) {\n                streamObj.filename = __getFilename(streamObj.input);\n              }\n              if (!streamObj.outputStack) streamObj.outputStack = {};\n              if (streamObj.outputDir && streamObj.filename && streamObj.data) {\n                streamObj.outputStack.data = __path.resolve(\n                  streamObj.outputDir,\n                  streamObj.filename\n                );\n              }\n              if (\n                streamObj.outputDir &&\n                streamObj.filename &&\n                streamObj.sourcemapData\n              ) {\n                streamObj.outputStack.sourcemapData = __path.resolve(\n                  streamObj.outputDir,\n                  streamObj.filename + '.map'\n                );\n              }\n              return streamObj;\n            }\n          }\n        },\n        settings\n      )\n    );\n  }\n};\n"]}
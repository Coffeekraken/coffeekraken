{"version":3,"sources":["SBuildScssActionsStream.js"],"names":["__SActionsStream","require","__deepMerge","__getFilename","__SFsOutputStreamAction","__SJsObjectToScssStreamAction","__SImportsStreamAction","__SBundleScssStreamAction","__SRenderSassStreamAction","__SPostCssStreamAction","__SSugarJsonStreamAction","__SFsFilesResolverStreamAction","__SFsCacheStreamAction","__SExtractStreamAction","__path","__sugarConfig","stream","module","exports","settings","filesResolver","fsCache","bundle","sugarJson","imports","jsConfig","render","extract","postCss","fsOutput","id","name","actions","out","before","streamObj","jsObjectToScss","afterActions","filename","input","beforeActions","outputStack","outputDir","data","resolve","prod","replace"],"mappings":"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","sourcesContent":["const __SActionsStream = require('../../stream/SActionsStream');\nconst __deepMerge = require('../../object/deepMerge');\nconst __getFilename = require('../../fs/filename');\nconst __SFsOutputStreamAction = require('../../stream/actions/SFsOutputStreamAction');\nconst __SJsObjectToScssStreamAction = require('./actions/SJsObjectToScssStreamAction');\nconst __SImportsStreamAction = require('./actions/SImportsStreamAction');\nconst __SBundleScssStreamAction = require('./actions/SBundleScssStreamAction');\nconst __SRenderSassStreamAction = require('./actions/SRenderSassStreamAction');\nconst __SPostCssStreamAction = require('./actions/SPostCssStreamAction');\nconst __SSugarJsonStreamAction = require('./actions/SSugarJsonStreamAction');\nconst __SFsFilesResolverStreamAction = require('../../stream/actions/SFsFilesResolverStreamAction');\nconst __SFsCacheStreamAction = require('../../stream/actions/SFsCacheStreamAction');\nconst __SExtractStreamAction = require('../../stream/actions/SExtractStreamAction');\nconst __path = require('path');\nconst __sugarConfig = require('../../config/sugar');\nconst { stream } = require('globby');\n\n/**\n * @name            SBuildScssActionsStream\n * @namespace           node.build.scss\n * @type            Class\n * @extends         SActionsStream\n *\n * This class represent a pre-configured action stream to build easily some javascript files\n *\n * @param           {Object}Â          [settings={}]         The settings object to configure your instance\n *\n * @todo        Document the streamObj required properties\n *\n * @example         js\n * const SBuildScssActionsStream = require('@coffeekraken/sugar/node/build/SBuildScssActionsStream');\n * const myStream = new SBuildScssActionsStream();\n * myStream.start({\n *    input: '...',\n *    outputDir: '...'\n * }).on('resolve', (result) => {\n *    // do something\n * });\n *\n * @since     2.0.0\n * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nmodule.exports = class SBuildScssActionsStream extends __SActionsStream {\n  /**\n   * @name        constructor\n   * @type        Function\n   * @constructor\n   *\n   * Constructor\n   *\n   * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n   */\n  constructor(settings = {}) {\n    // init actions stream\n    super(\n      {\n        filesResolver: __SFsFilesResolverStreamAction,\n        fsCache: __SFsCacheStreamAction,\n        bundle: __SBundleScssStreamAction,\n        sugarJson: __SSugarJsonStreamAction,\n        imports: __SImportsStreamAction,\n        jsConfig: __SJsObjectToScssStreamAction,\n        render: __SRenderSassStreamAction,\n        extract: __SExtractStreamAction,\n        postCss: __SPostCssStreamAction,\n        fsOutput: __SFsOutputStreamAction\n      },\n      __deepMerge(\n        {\n          id: 'actionStream.build.scss',\n          name: 'Build SCSS',\n          actions: {\n            filesResolver: {\n              out: 'array'\n            }\n          },\n          before: (streamObj) => {\n            streamObj.jsObjectToScss = __sugarConfig('scss');\n            return streamObj;\n          },\n          afterActions: {\n            filesResolver: (streamObj) => {\n              streamObj.filename = __getFilename(streamObj.input);\n              return streamObj;\n            }\n          },\n          beforeActions: {\n            fsCache: (streamObj) => {\n              if (!streamObj.outputStack) streamObj.outputStack = {};\n              if (streamObj.outputDir && streamObj.filename) {\n                streamObj.outputStack.data = __path.resolve(\n                  streamObj.outputDir,\n                  streamObj.prod\n                    ? streamObj.filename.replace('.scss', '.prod.css')\n                    : streamObj.filename.replace('.scss', '.css')\n                );\n              }\n              return streamObj;\n            },\n            fsOutput: (streamObj) => {\n              return streamObj;\n            }\n          }\n        },\n        settings\n      )\n    );\n  }\n};\n"]}
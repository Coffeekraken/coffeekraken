{"version":3,"sources":["SRenderSassStreamAction.js"],"names":["__SActionsStreamAction","require","__sass","__deepMerge","__packageRoot","__globImporter","__getFilename","__SPromise","module","exports","settings","name","id","streamObj","resolve","reject","trigger","cancel","render","importer","data","includePaths","input","replace","process","cwd","__dirname","sourceMap","map","err","result","formatted","toString","resultString","css","sourcemapData","type","required"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAMA,sBAAsB,GAAGC,OAAO,CAAC,sCAAD,CAAtC;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,MAAD,CAAtB;;AACA,MAAME,WAAW,GAAGF,OAAO,CAAC,2BAAD,CAA3B;;AACA,MAAMG,aAAa,GAAGH,OAAO,CAAC,2BAAD,CAA7B;;AACA,MAAMI,cAAc,GAAGJ,OAAO,CAAC,yBAAD,CAA9B;;AACA,MAAMK,aAAa,GAAGL,OAAO,CAAC,sBAAD,CAA7B;;AACA,MAAMM,UAAU,GAAGN,OAAO,CAAC,2BAAD,CAA1B;AAEA;;;;;;;;;;;;;;;AAaAO,MAAM,CAACC,OAAP;AAAA;;AAAA;;AACE;;;;;;;;;;AAoBA;;;;;;;;;AASA,mCAAYC,QAAZ,EAA2B;AAAA,QAAfA,QAAe;AAAfA,MAAAA,QAAe,GAAJ,EAAI;AAAA;;AAAA;;AAAA,6BAEvBP,WAAW,CACT;AACEQ,MAAAA,IAAI,EAAE,QADR;AAEEC,MAAAA,EAAE,EAAE;AAFN,KADS,EAKTF,QALS,CAFY;AAU1B;AAED;;;;;;;;;;;AA1CF;AAAA;AAAA,wBAmDMG,SAnDN,EAmDiBH,QAnDjB,EAmD2B;AACvB,8FAAiBG,SAAjB,EAA4B,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,OAAxB,EAAiCC,MAAjC,KAA4C;AACtEf,QAAAA,MAAM,CAACgB,MAAP,CACEf,WAAW,CACT;AACEgB,UAAAA,QAAQ,EAAEd,cAAc,EAD1B;AAEEe,UAAAA,IAAI,EAAEP,SAAS,CAACO,IAFlB;AAGEC,UAAAA,YAAY,EAAE,CACX,GAAER,SAAS,CAACS,KAAV,CAAgBC,OAAhB,CAAwBjB,aAAa,CAACO,SAAS,CAACS,KAAX,CAArC,EAAwD,EAAxD,CAA4D,EADnD,EAEX,GAAElB,aAAa,CAACoB,OAAO,CAACC,GAAR,EAAD,CAAgB,eAFpB,EAGX,GAAErB,aAAa,CAACsB,SAAD,CAAY,WAHhB,EAIX,GAAEtB,aAAa,CAACoB,OAAO,CAACC,GAAR,EAAD,CAAgB,WAJpB,CAHhB;AASEE,UAAAA,SAAS,EAAEd,SAAS,CAACe;AATvB,SADS,EAYTlB,QAZS,CADb,EAeE,gBAAgBmB,GAAhB,EAAqBC,MAArB,EAA6B;AAC3B,cAAID,GAAJ,EAAS;AACPd,YAAAA,MAAM,CAACc,GAAG,CAACE,SAAJ,GAAgBF,GAAG,CAACE,SAApB,GAAgCF,GAAG,CAACG,QAAJ,EAAjC,CAAN;AACA;AACD;;AAED,gBAAMC,YAAY,GAAGH,MAAM,CAACI,GAAP,CAAWF,QAAX,EAArB,CAN2B,CAO3B;;AACAnB,UAAAA,SAAS,CAACO,IAAV,GAAiBa,YAAjB,CAR2B,CAU3B;;AACA,cAAIH,MAAM,CAACF,GAAX,EAAgB;AACdf,YAAAA,SAAS,CAACsB,aAAV,GAA0BL,MAAM,CAACF,GAAP,CAAWI,QAAX,EAA1B;AACD,WAb0B,CAe3B;;;AACAlB,UAAAA,OAAO,CAACD,SAAD,CAAP;AACD,SAhCH;AAkCD,OAnCD;AAoCD;AAxFH;;AAAA;AAAA,EAAuDb,sBAAvD,4CAUyB;AACrBoB,EAAAA,IAAI,EAAE;AACJgB,IAAAA,IAAI,EAAE,QADF;AAEJC,IAAAA,QAAQ,EAAE;AAFN,GADe;AAKrBT,EAAAA,GAAG,EAAE;AACHQ,IAAAA,IAAI,EAAE,SADH;AAEHC,IAAAA,QAAQ,EAAE;AAFP;AALgB,CAVzB","sourcesContent":["const __SActionsStreamAction = require('../../../stream/SActionsStreamAction');\nconst __sass = require('sass');\nconst __deepMerge = require('../../../object/deepMerge');\nconst __packageRoot = require('../../../path/packageRoot');\nconst __globImporter = require('node-sass-glob-importer');\nconst __getFilename = require('../../../fs/filename');\nconst __SPromise = require('../../../promise/SPromise');\n\n/**\n * @name                SRenderSassStreamAction\n * @namespace           node.build.scss.actions\n * @type                Class\n * @extends             SActionsStreamAction\n *\n * This function is responsible of rendering the sass string in the \"data\" property\n *\n * @param       {Object}Â        streamObj          The streamObj object with the properties described bellow:\n * @return      {Promise}                         A simple promise that will be resolved when the process is finished\n *\n * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nmodule.exports = class SRenderSassStreamAction extends __SActionsStreamAction {\n  /**\n   * @name            definitionObj\n   * @type             Object\n   * @static\n   *\n   * Store the definition object that specify the streamObj required properties, types, etc...\n   *\n   * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n   */\n  static definitionObj = {\n    data: {\n      type: 'String',\n      required: true\n    },\n    map: {\n      type: 'Boolean',\n      required: false\n    }\n  };\n\n  /**\n   * @name            constructor\n   * @type            Function\n   * @constructor\n   *\n   * Constructor\n   *\n   * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n   */\n  constructor(settings = {}) {\n    super(\n      __deepMerge(\n        {\n          name: 'Render',\n          id: 'actionStream.action.scss.render'\n        },\n        settings\n      )\n    );\n  }\n\n  /**\n   * @name          run\n   * @type          Function\n   * @async\n   *\n   * Override the base class run method\n   *\n   * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n   */\n  run(streamObj, settings) {\n    return super.run(streamObj, async (resolve, reject, trigger, cancel) => {\n      __sass.render(\n        __deepMerge(\n          {\n            importer: __globImporter(),\n            data: streamObj.data,\n            includePaths: [\n              `${streamObj.input.replace(__getFilename(streamObj.input), '')}`,\n              `${__packageRoot(process.cwd())}/node_modules`,\n              `${__packageRoot(__dirname)}/src/scss`,\n              `${__packageRoot(process.cwd())}/src/scss`\n            ],\n            sourceMap: streamObj.map\n          },\n          settings\n        ),\n        async function (err, result) {\n          if (err) {\n            reject(err.formatted ? err.formatted : err.toString());\n            return;\n          }\n\n          const resultString = result.css.toString();\n          // save the new css into \"data\"\n          streamObj.data = resultString;\n\n          // save the map if exist into \"sourcemapData\"\n          if (result.map) {\n            streamObj.sourcemapData = result.map.toString();\n          }\n\n          // resolve the action\n          resolve(streamObj);\n        }\n      );\n    });\n  }\n};\n"]}
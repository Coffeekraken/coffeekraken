{"version":3,"sources":["AppControllers.js"],"names":["module","exports","config","req","res","value","params","Squid","send","meta","js","squidCommon","__fs","readFileSync","__dirname","projectCommon","process","cwd","resultingScript"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB;AACf;;;;;;;;;;;;AAYAC,EAAAA,MAAM,EAAE,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC1B,QAAIC,KAAJ;;AAEA,QAAIF,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAJ,EAAmB;AACjBD,MAAAA,KAAK,GAAG,MAAME,KAAK,CAACL,MAAN,CAAaC,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAb,CAAd;AACD,KAFD,MAEO;AACLD,MAAAA,KAAK,GAAG,MAAME,KAAK,CAACL,MAAN,EAAd;AACD;;AAEDE,IAAAA,GAAG,CAACI,IAAJ,CAASH,KAAT;AACD,GAvBc;;AAyBf;;;;;;;;;;;;AAYAI,EAAAA,IAAI,EAAE,CAACN,GAAD,EAAMC,GAAN,KAAc;AAClB,QAAIC,KAAJ;;AAEA,QAAIF,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAJ,EAAmB;AACjBD,MAAAA,KAAK,GAAGE,KAAK,CAACE,IAAN,CAAWN,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAX,CAAR;AACD,KAFD,MAEO;AACLD,MAAAA,KAAK,GAAGE,KAAK,CAACE,IAAN,EAAR;AACD;;AAEDL,IAAAA,GAAG,CAACI,IAAJ,CAASH,KAAT;AACD,GA/Cc;;AAiDf;;;;;;;;;;;;AAYAK,EAAAA,EAAE,EAAE,OAAOP,GAAP,EAAYC,GAAZ,KAAoB;AACtB;AACA,UAAMO,WAAW,GAAGC,IAAI,CAACC,YAAL,CACjB,GAAEC,SAAU,gBAAe,MAAMP,KAAK,CAACL,MAAN,CAChC,sBADgC,CAEhC,mBAHgB,CAApB,CAFsB,CAOtB;;;AACA,UAAMa,aAAa,GAAGH,IAAI,CAACC,YAAL,CACnB,GAAEG,OAAO,CAACC,GAAR,EAAc,IAAG,MAAMV,KAAK,CAACL,MAAN,CACxB,sBADwB,CAExB,mBAHkB,CAAtB;;AAMA,QAAIgB,eAAe,GAAI,GAAEP,WAAY,GAAEI,aAAc,EAArD,CAdsB,CAetB;AACA;AACA;AACA;AACA;AAEA;;AACAX,IAAAA,GAAG,CAACI,IAAJ,CAASU,eAAT;AACD;AApFc,CAAjB","sourcesContent":["module.exports = {\n  /**\n   * @name                          config\n   * @namespace           node.express.controllers.AppControllers\n   * @type                          Function\n   *\n   * Return the whole configuration object or the specified value requested using the dot formated object key.\n   *\n   * @param                     {Object}                      req                     The express \"req\" object\n   * @param                     {Object}                      res                     The express \"res\" object\n   *\n   * @author \t\t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com\n   */\n  config: async (req, res) => {\n    let value;\n\n    if (req.params[0]) {\n      value = await Squid.config(req.params[0]);\n    } else {\n      value = await Squid.config();\n    }\n\n    res.send(value);\n  },\n\n  /**\n   * @name                          meta\n   * @namespace           node.express.controllers.AppControllers\n   * @type                          Function\n   *\n   * Return the application meta data\n   *\n   * @param                     {Object}                      req                     The express \"req\" object\n   * @param                     {Object}                      res                     The express \"res\" object\n   *\n   * @author \t\t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com\n   */\n  meta: (req, res) => {\n    let value;\n\n    if (req.params[0]) {\n      value = Squid.meta(req.params[0]);\n    } else {\n      value = Squid.meta();\n    }\n\n    res.send(value);\n  },\n\n  /**\n   * @name                js\n   * @namespace           node.express.controllers.AppControllers\n   * @type                Function\n   *\n   * Handle the base javascript route that serve the global and common files\n   *\n   * @param         {Object}        req           The req express object\n   * @param         {Object}        res            The res express object\n   *\n   * @author \t\t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com\n   */\n  js: async (req, res) => {\n    // read the common squid framework file\n    const squidCommon = __fs.readFileSync(\n      `${__dirname}/../../../../${await Squid.config(\n        'dist.js.outputFolder'\n      )}/common.bundle.js`\n    );\n    // read the common project file\n    const projectCommon = __fs.readFileSync(\n      `${process.cwd()}/${await Squid.config(\n        'dist.js.outputFolder'\n      )}/common.bundle.js`\n    );\n\n    let resultingScript = `${squidCommon}${projectCommon}`;\n    // resultingScript += `\n    //   window.__squid = {\n    //     config: '${__base64.encrypt(JSON.stringify(Squid.config))}',\n    //     meta: '${__base64.encrypt(JSON.stringify(require(process.cwd() + '/package.json')))}'\n    //   };`;\n\n    // send gziped javascript files Content\n    res.send(resultingScript);\n  }\n};\n"]}
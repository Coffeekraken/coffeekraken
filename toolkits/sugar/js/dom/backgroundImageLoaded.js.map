{
    "version": 3,
    "sources": [
        "backgroundImageLoaded.js"
    ],
    "names": [
        "backgroundImageLoaded",
        "$elm",
        "isCancelled",
        "$img",
        "promise",
        "__SPromise",
        "resolve",
        "reject",
        "trigger",
        "cancel",
        "backgroundImage",
        "matches",
        "match",
        "url",
        "Image",
        "src",
        "then",
        "id",
        "on",
        "__$img"
    ],
    "mappings": ";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA;;;;;;;;;;;;;;;;;;AAkBe,SAASA,qBAAT,CAA+BC,IAA/B,EAAqC;AAClD,MAAIC,WAAW,GAAG,KAAlB;AAAA,MACEC,IADF;AAEA,MAAMC,OAAO,GAAG,IAAIC,iBAAJ,CACd,CAACC,OAAD,EAAUC,MAAV,EAAkBC,OAAlB,EAA2BC,MAA3B,KAAsC;AACpC;AACA,QAAMC,eAAe,GAAG,+BAAmBT,IAAnB,EAAyB,kBAAzB,CAAxB;AACA,QAAMU,OAAO,GAAGD,eAAe,CAACE,KAAhB,CAAsB,iBAAtB,CAAhB;;AACA,QAAI,CAACD,OAAD,IAAY,CAACA,OAAO,CAAC,CAAD,CAAxB,EAA6B;AAC3BJ,MAAAA,MAAM,CAAC,kCAAD,CAAN;AACA;AACD,KAPmC,CAQpC;;;AACA,QAAMM,GAAG,GAAG,sBAAUF,OAAO,CAAC,CAAD,CAAjB,CAAZ,CAToC,CAUpC;;AACAR,IAAAA,IAAI,GAAG,IAAIW,KAAJ,EAAP;AACAX,IAAAA,IAAI,CAACY,GAAL,GAAWF,GAAX,CAZoC,CAapC;;AACA,8BAAcV,IAAd,EAAoBa,IAApB,CAAyB,MAAM;AAC7B,UAAI,CAACd,WAAL,EAAkBI,OAAO,CAACL,IAAD,CAAP;AACnB,KAFD;AAGD,GAlBa,EAmBd;AACEgB,IAAAA,EAAE,EAAE;AADN,GAnBc,EAsBdC,EAtBc,CAsBX,SAtBW,EAsBA,MAAM;AACpBhB,IAAAA,WAAW,GAAG,IAAd;AACD,GAxBe,CAAhB;AAyBAE,EAAAA,OAAO,CAACe,MAAR,GAAiBhB,IAAjB;AACA,SAAOC,OAAP;AACD",
    "sourcesContent": [
        "import __getStyleProperty from './getStyleProperty';\nimport __imageLoaded from './imageLoaded';\nimport __unquote from '../string/unquote';\nimport __SPromise from '../promise/SPromise';\n\n/**\n * @name        backgroundImageLoaded\n * @namespace           sugar.js.dom\n * @type      Function\n *\n * Detect when a background image has been loaded on an HTMLElement\n *\n * @param    {HTMLElement}    $elm    The HTMLElement on which to detect the background image load\n * @return    {SPromise}    A promise that will be resolved when the background image has been loaded\n *\n * @example    js\n * import backgroundImageLoaded from '@coffeekraken/sugar/js/dom/backgroundImageLoaded'\n * backgroundImageLoaded($myElm).then(() => {\n *   // do something when loaded\n * })\n *\n * @author    Olivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nexport default function backgroundImageLoaded($elm) {\n  let isCancelled = false,\n    $img;\n  const promise = new __SPromise(\n    (resolve, reject, trigger, cancel) => {\n      // get the background-image property from computed style\n      const backgroundImage = __getStyleProperty($elm, 'background-image');\n      const matches = backgroundImage.match(/.*url\\((.*)\\).*/);\n      if (!matches || !matches[1]) {\n        reject('No background image url found...');\n        return;\n      }\n      // process url\n      const url = __unquote(matches[1]);\n      // make a new image with the image set\n      $img = new Image();\n      $img.src = url;\n      // return the promise of image loaded\n      __imageLoaded($img).then(() => {\n        if (!isCancelled) resolve($elm);\n      });\n    },\n    {\n      id: 'backgroundImageLoaded'\n    }\n  ).on('finally', () => {\n    isCancelled = true;\n  });\n  promise.__$img = $img;\n  return promise;\n}\n"
    ]
}
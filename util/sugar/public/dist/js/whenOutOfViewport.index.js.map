{"version":3,"sources":["webpack:///./src/js/dom/closest.js","webpack:///./src/js/dom/isInViewport.js","webpack:///./src/js/dom/matches.js","webpack:///./src/js/dom/whenOutOfViewport.js","webpack:///./src/js/function/throttle.js"],"names":["closest","$elm","selector","originalElm","parentNode","ownerDocument","isInViewport","elm","offset","offsetTop","offsetRight","offsetBottom","offsetLeft","top","right","bottom","left","containerHeight","window","innerHeight","document","documentElement","clientHeight","containerWidth","innerWidth","clientWidth","rect","getBoundingClientRect","isTopIn","isBottomIn","isLeftIn","isRightIn","matches","el","nodeName","p","Element","prototype","f","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","s","indexOf","call","querySelectorAll","whenOutOfViewport","Promise","resolve","reject","IntersectionObserver","_cb","observer","disconnect","entries","length","entry","intersectionRatio","root","rootMargin","threshold","observe","scrollContainerElm","_inViewportContainer","overflowContainer","removeEventListener","checkViewport","e","addEventListener","setTimeout","throttle","fn","threshhold","last","context","now","Date","args","arguments","apply"],"mappings":"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","file":"whenOutOfViewport.index.js","sourcesContent":["import __matches from './matches';\n\n/**\n * @name        closest\n * @namespace           js.dom\n * @type      Function\n *\n * Go up the dom three to find the first element that matches the passed selector\n *\n * @param \t\t{HTMLElement} \t\t\t\t\t$elm  \t\tThe element to start on\n * @param \t\t{String|Function} \t\t\t\tselector \tA css selector to search for or a check function that will be used\n * @return \t\t{HTMLElement} \t\t\t\t\t\t\t\tThe element found or null\n *\n * @example  \tjs\n * import closest from '@coffeekraken/sugar/js/dom/closest'\n * const closestElm = closest(myCoolElement, '.my-cool-class');\n * if (closestElm) {\n * \t\t// we have found en element that matches the selector\n * }\n * // the selector param can be a function that need to return either true or false like so:\n * closest(myCoolElement, (elm) => {\n *   return elm.hasAttribute('my-cool-attribute')\n * })\n *\n * @author \t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nexport default function closest($elm, selector) {\n  const originalElm = $elm;\n  $elm = $elm.parentNode;\n  while ($elm && $elm != originalElm.ownerDocument) {\n    if (typeof selector === 'function') {\n      if (selector($elm)) return $elm;\n    } else if (typeof selector === 'string' && __matches($elm, selector)) {\n      return $elm;\n    }\n    $elm = $elm.parentNode;\n  }\n  return null;\n}\n","// TODO tests\n\n/**\n * @name      isInViewport\n * @namespace           js.dom\n * @type      Function\n *\n * Check if the passed HTMLElement is in the viewport or not\n *\n * @param \t\t{HTMLElement} \t\t\t\telm  \t\t\tThe element to insert\n * @param \t\t{Object} \t\t\t\t\t[offset=50] \tAn object of top, right, bottom and left offset used to detect the status or an object with top, right, bottom and left offsets\n * @return \t\t{Boolean}\t\t\t\t\t\t\t\t\tIf the element is in the viewport or not\n *\n * @example  \tjs\n * import isInViewport from '@coffeekraken/sugar/js/dom/isInViewport'\n * if (isInViewport(myCoolHTMLElement) {\n * \t\t// i'm in the viewport\n * }\n *\n * @author \t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nexport default function isInViewport(elm, offset = 50) {\n  // handle offset\n  let offsetTop = offset;\n  let offsetRight = offset;\n  let offsetBottom = offset;\n  let offsetLeft = offset;\n  if (typeof offset === 'object') {\n    offsetTop = offset.top || 0;\n    offsetRight = offset.right || 0;\n    offsetBottom = offset.bottom || 0;\n    offsetLeft = offset.left || 0;\n  }\n  const containerHeight =\n    window.innerHeight || document.documentElement.clientHeight;\n  const containerWidth =\n    window.innerWidth || document.documentElement.clientWidth;\n  const rect = elm.getBoundingClientRect();\n  const isTopIn = rect.top - containerHeight - offsetBottom <= 0;\n  const isBottomIn = rect.bottom - offsetTop >= 0;\n  const isLeftIn = rect.left - containerWidth - offsetRight <= 0;\n  const isRightIn = rect.right - offsetLeft >= 0;\n  return isTopIn && isBottomIn && isLeftIn && isRightIn;\n}\n","/**\n * @name      matches\n * @namespace           js.dom\n * @type      Function\n *\n * Polyfill for the Element.matches function\n *\n * @param \t\t{HTMLElement} \t\t\telm  \t\t\tThe element to check\n * @param \t\t{String} \t\t\t\tselector \t\tThe selector to check on the element\n * @return \t\t{Boolean} \t\t\t\t\t\t\t\tIf the element match the selector or not\n *\n * @example  \tjs\n * import matches from '@coffeekraken/sugar/js/dom/matches'\n * if (matches(myCoolHTMLElement, '.my-cool-css-selector')) {\n * \t\t// the element match the selector\n * }\n *\n * @see \t\thttps://developer.mozilla.org/en/docs/Web/API/Element/matches\n * @author \t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nexport default function matches(el, selector) {\n  if (el.nodeName == '#comment' || el.nodeName == '#text') {\n    return false;\n  }\n  var p = Element.prototype;\n  var f =\n    p.matches ||\n    p.webkitMatchesSelector ||\n    p.mozMatchesSelector ||\n    p.msMatchesSelector ||\n    function (s) {\n      return [].indexOf.call(document.querySelectorAll(s), this) !== -1;\n    };\n  return f.call(el, selector);\n}\n","import __isInViewport from './isInViewport';\nimport __throttle from '../function/throttle';\nimport __closest from './closest';\n\n// TODO tests\n\n/**\n * @name      whenOutOfViewport\n * @namespace           js.dom\n * @type      Function\n *\n * Monitor an HTMLElement to be notified when it exit the viewport\n *\n * @param \t\t{HTMLElement} \t\t\t\telm \t\t\t\tThe element to monitor\n * @param \t\t{Number} \t\t\t\t\t[offset=50] \t\tAn offset that represent the distance before entering the viewport for the detection\n * @return \t\t(Promise) \t\t\t\t\t\t\t\t\t\tThe promise that will be resolved when the element exit the viewport\n *\n * @example \tjs\n * import whenOutOfViewport from '@coffeekraken/sugar/js/dom/whenOutOfViewport'\n * whenOutOfViewport(myCoolHTMLElement).then((elm) => {\n * \t\t// do something with your element that has exit the viewport...\n * });\n *\n * @author \t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nexport default function whenOutOfViewport(elm, offset = 50) {\n  return new Promise((resolve, reject) => {\n    if (window.IntersectionObserver) {\n      let isInViewport = false,\n        _cb = () => {\n          if (!isInViewport) {\n            observer.disconnect();\n            resolve(elm);\n          }\n        };\n\n      const observer = new IntersectionObserver(\n        (entries, observer) => {\n          if (!entries.length) return;\n          const entry = entries[0];\n          if (entry.intersectionRatio > 0) {\n            isInViewport = true;\n          } else {\n            isInViewport = false;\n          }\n          _cb();\n        },\n        {\n          root: null, // viewport\n          rootMargin: `${offset}px`,\n          threshold: [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1]\n        }\n      );\n\n      observer.observe(elm);\n    } else {\n      // try to get the closest element that has an overflow\n      let scrollContainerElm = document;\n      if (!elm._inViewportContainer) {\n        const overflowContainer = __closest(\n          elm,\n          '[data-in-viewport-container]'\n        );\n        if (overflowContainer) {\n          scrollContainerElm = overflowContainer;\n          elm._inViewportContainer = overflowContainer;\n        }\n      } else {\n        scrollContainerElm = elm._inViewportContainer;\n      }\n\n      let isInViewport = true,\n        _cb = () => {\n          if (!isInViewport) {\n            scrollContainerElm.removeEventListener('scroll', checkViewport);\n            window.removeEventListener('resize', checkViewport);\n            resolve(elm);\n          }\n        };\n      let checkViewport = __throttle((e) => {\n        isInViewport = __isInViewport(elm, offset);\n        _cb();\n      }, 100);\n\n      // listen for resize\n      scrollContainerElm.addEventListener('scroll', checkViewport);\n      window.addEventListener('resize', checkViewport);\n      setTimeout(() => {\n        checkViewport(null);\n      });\n    }\n  });\n}\n","/**\n * @name        throttle\n * @namespace           js.function\n * @type      Function\n *\n * This utils function allows you to make sure that a function that will normally be called\n * several times, for example during a scroll event, to be called once each threshhold time\n *\n * @example \t\tjs\n * import throttle from '@coffeekraken/sugar/js/function/throttle';\n * const myThrottledFn = throttle(() => {\n * \t\t// my function content that will be\n * \t\t// executed only once each second\n * }, 1000);\n *\n * document.addEventListener('scroll', (e) => {\n * \t\t// call my throttled function\n * \t\tmyThrottledFn();\n * });\n *\n * @author \t\t\tOlivier Bossel <olivier.bossel@gmail.com> (https://olivierbossel.com)\n */\nexport default function throttle(fn, threshhold) {\n  threshhold || (threshhold = 250);\n  var last;\n  return function () {\n    var context = this;\n    var now = new Date(),\n      args = arguments;\n    if (!last || last <= now - threshhold) {\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n"],"sourceRoot":""}